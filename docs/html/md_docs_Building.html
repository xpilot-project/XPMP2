<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>XPMP2: Building XPMP2 and the Sample Plugin</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">XPMP2
   </div>
   <div id="projectbrief">X-Plane multiplayer library 2 - using instancing</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Building <a class="el" href="namespaceXPMP2.html" title="Defined by FMOD.">XPMP2</a> and the Sample Plugin </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md2"></a>
Two Projects: XPMP2 Full Build and Sample Plugin only</h1>
<p>There are two separate projects provided in the <a class="el" href="namespaceXPMP2.html" title="Defined by FMOD.">XPMP2</a> repository:</p>
<ul>
<li>One based in the <a class="el" href="namespaceXPMP2.html" title="Defined by FMOD.">XPMP2</a> root folder. This project builds all 3 targets:<ul>
<li>The <a class="el" href="namespaceXPMP2.html" title="Defined by FMOD.">XPMP2</a> static library, which is also copied into <code>XPMP2-Sample/lib</code> so that is thereafter accessible by the stand-alone XPMP2-Sample project;</li>
<li>The <a class="el" href="namespaceXPMP2.html" title="Defined by FMOD.">XPMP2</a> Remote Client, which builds the <code>XPMP2-Remote.xpl</code> binary;</li>
<li>The <a class="el" href="namespaceXPMP2.html" title="Defined by FMOD.">XPMP2</a> Sample plugin, which builds the <code>XPMP2-Sample.xpl</code> binary, same as with the following stand-alone project.</li>
</ul>
</li>
<li>a stand-alone project only for the XPMP2-Sample plugin. This is provided separately so it can serve as basis for your own plugin implementations.</li>
</ul>
<p>Using either project works similarly when it comes to building. For the main <a class="el" href="namespaceXPMP2.html" title="Defined by FMOD.">XPMP2</a> projects start in the <a class="el" href="namespaceXPMP2.html" title="Defined by FMOD.">XPMP2</a> root folder. For the XPMP2-Sample stand-alone project start in the <code>XPMP2-Sample</code> folder.</p>
<p>Then, there are four options to build from sources:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Options   </th><th class="markdownTableHeadNone">Windows   </th><th class="markdownTableHeadNone">MacOS (universal)   </th><th class="markdownTableHeadNone">Linux    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>IDE</b>   </td><td class="markdownTableBodyNone">Visual Studio 2019   </td><td class="markdownTableBodyNone">XCode 12   </td><td class="markdownTableBodyNone">-    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Docker</b>   </td><td class="markdownTableBodyNone">Mingw64   </td><td class="markdownTableBodyNone">clang, SDK 12   </td><td class="markdownTableBodyNone">Focal and Bionic    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>CMake</b>   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">XCode 12   </td><td class="markdownTableBodyNone">Focal and Bionic    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Github Actions</b>   </td><td class="markdownTableBodyNone">Visual Studio 2022   </td><td class="markdownTableBodyNone">XCode 12   </td><td class="markdownTableBodyNone">Focal   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md3"></a>
Using an IDE</h1>
<h2>Windows</h2>
<ul>
<li>Install <a href="https://visualstudio.microsoft.com/vs/community/">Visual Studio</a></li>
<li>Open the root folder to build the <a class="el" href="namespaceXPMP2.html" title="Defined by FMOD.">XPMP2</a> library targets, or the <code>XPMP2-Sample</code> folder to only build the sample plugin ("File &gt; Open &gt; Folder", <a href="https://docs.microsoft.com/en-us/cpp/build/open-folder-projects-cpp?view=vs-2019">see here for VS's "Open Folder" functionality</a>)</li>
<li>In both cases will VS use the CMake setup to configure building the binaries.</li>
<li>Build from within Visual Studio.</li>
</ul>
<p>Results are in <code>build/x64</code>.</p>
<p>The <code>XPMP2.lib</code> library is also copied into <code>XPMP2-Sample/lib</code> to be available in a subsequent build of the sample plugin.</p>
<h2>MacOS</h2>
<p>My development environment is Mac OS, so expect the XCode environment to be maintained best. Open <code>XPMP2.xcodeproj</code> resp. <code>XPMP2-Sample/XPMP2-Sample.xcodeproj</code> in XCode.</p>
<p>In the XCode Build Settings you may want to change the definition of the User-Defined build macro <code>XPLANE11_ROOT</code>: Put in the path to your X-Plane 11 installation's root path, then the <a class="el" href="namespaceXPMP2.html" title="Defined by FMOD.">XPMP2</a> binaries will be installed right there in the appropriate <code>Resources/plugins</code> sub-folder structure.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Using Docker</h1>
<p>Docker environments based on Ubuntu 20.04 and 18.04 are used, which can build all 3 platforms, Linux even in two flavors.</p>
<ul>
<li>Install <a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a> and start it.</li>
<li><code>cd</code> to the project's <code>docker</code> folder, and enter <code>make</code> for all <a class="el" href="namespaceXPMP2.html" title="Defined by FMOD.">XPMP2</a> library targets on all platforms, or</li>
<li><code>cd</code> to <code>XPMP2-Sample/docker</code>, and enter <code>make</code> for the sample plugin only on all platforms.</li>
</ul>
<p>9 individual <code>make</code> targets are available:</p>
<ul>
<li><code>lin</code> builds Linux on Ubuntu 20.04</li>
<li><code>lin-bionic</code> builds Linux on Ubuntu 18.04</li>
<li><code>mac-arm</code> builds MacOS for Apple Silicon using <code>clang</code> as cross compiler</li>
<li><code>mac-x86</code> builds MacOS for x86 using <code>clang</code> as cross compiler</li>
<li><code>mac</code> builds <code>mac-arm</code> and <code>mac-x86</code> and then combines the results into a univeral binary</li>
<li><code>win</code> builds Windows using a Mingw64 cross compiler setup</li>
<li><code>bash_focal</code> starts a bash prompt in the Ubuntu 20.04 docker container</li>
<li><code>bash_bionic</code> starts a bash prompt in the Ubuntu 18.04 docker container</li>
<li><code>doc</code> builds the documentation based on Doxygen, will probably only work on a Mac with Doxygen provided in <code>Applications/Doxygen.app</code>.</li>
</ul>
<p>Find results in the respective <code>build-&lt;platform&gt;</code> folder, the <code><a class="el" href="namespaceXPMP2.html" title="Defined by FMOD.">XPMP2</a></code> library right there, the Sample and Remote plugins in their proper <code>&lt;platform&gt;_x64</code> subfolder.</p>
<p>The resulting library/framework are also copied into <code>XPMP2-Sample/lib/&lt;platform&gt;</code> so it is accessible if building the Sample plugin from the Sample project only.</p>
<p>For more details and background information on the provided Docker environments see the <code>docker/README.md</code>.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Using CMake</h1>
<p>Given a proper local setup with a suitable compile, CMake, and Ninja installed, you can just locally build the sources from the <code>CMakeList.txt</code> file, e.g. like this:</p>
<div class="fragment"><div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake -G Ninja ..</div>
<div class="line">ninja</div>
</div><!-- fragment --><p>This is precicely how the Mac and Linux builds are done in Github Actions.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Using Gitub Actions</h1>
<p>The GitHub workflow <code>.github/workflows/build.yml</code> builds the plugin in GitHubs CD/CI environment. <code>build.yml</code> calls a number of custom composite actions available in <code>.github/actions</code>, each coming with its own <code>README.md</code>.</p>
<p>The workflow builds Linux, MacOS, and Windows plugin binaries and provides them as artifacts, so you can download the result from the <em>Actions</em> tab on GitHub.</p>
<p>For <b>MacOS</b>, the plugin can be <b>signed and notarized</b>, provided that the required <em>Repository Secrets</em> are defined in the repository's settings (Settings &gt; Secrets &gt; Actions):</p><ul>
<li><code>MACOS_CERTIFICATE</code>: Base64-encoded .p12 certificate as <a href="https://localazy.com/blog/how-to-automatically-sign-macos-apps-using-github-actions#lets-get-started">explained here</a></li>
<li><code>MACOS_CERT_PWD</code>: The password for the above .p12 certificate file export</li>
<li><code>NOTARIZATION_USERNAME</code>: Apple ID for notarization service (parameter <code>--apple-id</code> to <code>notarytool</code>)</li>
<li><code>NOTARIZATION_TEAM</code>: Team ID for notarization service (parameter <code>--team-id</code> to <code>notarytool</code>)</li>
<li><code>NOTARIZATION_PASSWORD</code>: <a href="https://support.apple.com/en-gb/HT204397">App-specific password</a> for notarization service (parameter <code>--password</code> to <code>notarytool</code>) </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
